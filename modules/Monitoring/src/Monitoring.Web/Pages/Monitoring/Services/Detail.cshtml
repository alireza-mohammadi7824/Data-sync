@page "/Monitoring/Services/Detail/{Id:guid}"
@model Monitoring.Web.Pages.Monitoring.Services.DetailModel
@using Monitoring.Localization
@using Monitoring.Permissions
@inject Microsoft.AspNetCore.Mvc.Localization.IHtmlLocalizer<MonitoringResource> L

@{
    Layout = null;
}

@section main {
    @{ ViewData["Title"] = L["Monitoring:ServiceDetailsTitle", Model.Endpoint.Name]; }

    <abp-breadcrumb>
        <abp-breadcrumb-item href="~/Monitoring">@L["Monitoring:Title"]</abp-breadcrumb-item>
        <abp-breadcrumb-item>@Model.Endpoint.Name</abp-breadcrumb-item>
    </abp-breadcrumb>

    <div class="d-flex flex-column flex-lg-row gap-3 mb-4 align-items-lg-center justify-content-between">
        <div>
            <h1 class="mb-1">@L["Monitoring:ServiceDetailsHeading", Model.Endpoint.Name]</h1>
            <p class="text-muted mb-0">@L["Monitoring:ServiceDetailsDescription"]</p>
        </div>
        <div class="d-flex flex-wrap gap-2">
            <abp-authorize policy="@MonitoringPermissions.RunCheck">
                <abp-button button-type="Primary"
                            text="@L[\"Monitoring:RunCheckNow\"]"
                            icon="history"
                            disabled />
            </abp-authorize>
            <abp-authorize policy="@MonitoringPermissions.Edit">
                <abp-button button-type="OutlinePrimary"
                            text="@L[\"Monitoring:Actions.Edit\"]"
                            href="~/Monitoring/Services/Edit/@Model.Id"
                            icon="edit" />
            </abp-authorize>
        </div>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <dl class="row mb-0">
                <dt class="col-sm-3">@L["Monitoring:Fields.Name"]</dt>
                <dd class="col-sm-9">@Model.Endpoint.Name</dd>

                <dt class="col-sm-3">@L["Monitoring:Fields.Description"]</dt>
                <dd class="col-sm-9">@(string.IsNullOrWhiteSpace(Model.Endpoint.Description) ? L["Monitoring:DescriptionNotProvided"] : Model.Endpoint.Description)</dd>

                <dt class="col-sm-3">@L["Monitoring:Fields.ServiceType"]</dt>
                <dd class="col-sm-9">@Model.GetServiceTypeText(Model.Endpoint.ServiceType)</dd>

                <dt class="col-sm-3">@L["Monitoring:Fields.Target"]</dt>
                <dd class="col-sm-9 text-break">@Model.Endpoint.Target</dd>

                <dt class="col-sm-3">@L["Monitoring:Fields.IsEnabled"]</dt>
                <dd class="col-sm-9">@Model.GetEnabledText(Model.Endpoint.IsEnabled)</dd>

                <dt class="col-sm-3">@L["Monitoring:Fields.CheckIntervalSeconds"]</dt>
                <dd class="col-sm-9">@Model.GetDurationText(Model.Endpoint.CheckIntervalSeconds)</dd>

                <dt class="col-sm-3">@L["Monitoring:Fields.TimeoutSeconds"]</dt>
                <dd class="col-sm-9">@Model.GetDurationText(Model.Endpoint.TimeoutSeconds)</dd>

                <dt class="col-sm-3">@L["Monitoring:LastKnownStatus"]</dt>
                <dd class="col-sm-9">
                    <span class="@Model.GetStatusBadgeClass(Model.Endpoint.LastKnownStatus)">
                        @Model.GetStatusText(Model.Endpoint.LastKnownStatus)
                    </span>
                </dd>

                <dt class="col-sm-3">@L["Monitoring:LastCheckTime"]</dt>
                <dd class="col-sm-9">
                    @if (Model.Endpoint.LastCheckTime.HasValue)
                    {
                        @Model.Endpoint.LastCheckTime.Value.ToLocalTime().ToString("f")
                    }
                    else
                    {
                        <span class="text-muted">@L["Monitoring:NeverChecked"]</span>
                    }
                </dd>

                <dt class="col-sm-3">@L["Monitoring:LastResponseTime"]</dt>
                <dd class="col-sm-9">@Model.GetResponseDurationText(Model.Endpoint.LastResponseDurationMilliseconds)</dd>
            </dl>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">
            <h2 class="h5 fw-semibold mb-3">@L["Monitoring:HistoryHeading"]</h2>
            <p class="text-muted mb-0">@L["Monitoring:HistoryPlaceholder"]</p>
        </div>
    </div>
}
